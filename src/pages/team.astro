---
// ========================================
// TEAM PAGE
// Clean, modern team page aligned with template design
// Uses configurable TeamGrid component
// ========================================

import Layout from '../layouts/Layout.astro'
import { TeamGrid } from '../components/team'
import { getTeamMembers } from '../lib/api'
import { fetchBrandSettings, getContactInfo } from '../lib/brand'

// Fetch brand settings
const brand = await fetchBrandSettings()
const contact = getContactInfo(brand)

// Fetch team members
const teamResponse = await getTeamMembers({ limit: 50 })
const allMembers = teamResponse?.members || []

const pageTitle = `Our Team | ${brand.business_name}`
const pageDescription = `Meet the dedicated team at ${brand.business_name}. Our experienced property professionals are here to help with all your real estate needs.`

// Stats
const stats = [
  { value: allMembers.length.toString(), label: 'Team Members', icon: 'users' },
  { value: '15+', label: 'Years Experience', icon: 'check' },
  { value: '98%', label: 'Client Satisfaction', icon: 'star' }
]
---

<Layout title={pageTitle} description={pageDescription}>
  <div class="team-page">

    <!-- Page Header -->
    <section class="team-header">
      <div class="team-header__content">
        <h1 class="team-header__title">Meet Our Team</h1>
        <p class="team-header__subtitle">
          Our dedicated team of property experts brings years of local knowledge and expertise to help you achieve your property goals.
        </p>
      </div>
    </section>

    <!-- Stats Section -->
    <section class="team-stats">
      <div class="team-stats__container">
        {stats.map((stat) => (
          <div class="stat-item">
            <div class="stat-item__icon">
              {stat.icon === 'users' && (
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                  <circle cx="9" cy="7" r="4"/>
                  <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                  <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
              )}
              {stat.icon === 'check' && (
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
              )}
              {stat.icon === 'star' && (
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                </svg>
              )}
            </div>
            <div class="stat-item__value">{stat.value}</div>
            <div class="stat-item__label">{stat.label}</div>
          </div>
        ))}
      </div>
    </section>

    <!-- Team Grid (handles featured/regular separation automatically) -->
    <section class="team-section">
      <div class="team-section__container">
        <TeamGrid
          members={allMembers}
          configId="fullPage"
          showFeatured={true}
          emptyMessage="No team members yet. Check back soon to meet our team."
        />
      </div>
    </section>

    <!-- CTA Section -->
    <section class="team-cta">
      <div class="team-cta__container">
        <h2 class="team-cta__title">Want to Join Our Team?</h2>
        <p class="team-cta__text">
          We're always looking for talented individuals to join our growing team. If you're passionate about property and delivering excellent customer service, we'd love to hear from you.
        </p>
        <div class="team-cta__actions">
          <a href="/contact" class="team-cta__btn team-cta__btn--primary">
            Get in Touch
          </a>
          {contact.email && (
            <a href={`mailto:${contact.email}?subject=Career%20Enquiry`} class="team-cta__btn team-cta__btn--secondary">
              Email Us
            </a>
          )}
        </div>
      </div>
    </section>

  </div>
</Layout>

<style lang="scss">
  @use '../styles/pages/team';
</style>
