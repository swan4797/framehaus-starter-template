---
// ========================================
// SELLERS PAGE
// Services page for property sellers
// Dynamic content from Stratos CRM
// ========================================

import Layout from '../layouts/Layout.astro'

// Static Page Components
import StaticPageLayout from '../components/static-page/layout/StaticPageLayout.astro'
import StaticHero from '../components/static-page/hero/StaticHero.astro'
import ShowcaseGrid from '../components/static-page/showcase/ShowcaseGrid.astro'
import ShowcaseCard from '../components/static-page/showcase/ShowcaseCard.astro'
import ContentSection from '../components/static-page/content/ContentSection.astro'
import ContentRow from '../components/static-page/content/ContentRow.astro'

// Page content utilities
import { getPageContent, hasSection } from '../lib/pages'

// Page configuration
import { sellersPageConfig } from '../components/static-page/config'

const pageTitle = 'Selling Your Property'
const pageDescription = 'Expert guidance and support for selling your property. Get the best price with our experienced team.'

// Fetch sellers page content from Stratos CRM
const pageContent = await getPageContent('sellers')

// Check which sections exist in CRM
const hasOurApproach = hasSection(pageContent, 'our_approach')
const hasSellingProcess = hasSection(pageContent, 'selling_process')
const hasFees = hasSection(pageContent, 'fees')
---

<Layout title={pageTitle} description={pageDescription}>
  <StaticPageLayout>
    <!-- Hero Section -->
    <StaticHero
      label={sellersPageConfig.hero.label}
      titleLines={sellersPageConfig.hero.titleLines}
      tagline="With expert local knowledge and a proven track record, we'll help you achieve the best possible price for your property."
      ctaLabel={sellersPageConfig.hero.ctaLabel}
      ctaUrl={sellersPageConfig.hero.ctaUrl}
    />

    <!-- Showcase Section -->
    <ShowcaseGrid>
      <ShowcaseCard
        variant="primary"
        title="Maximise Your Sale Price"
        description="Our marketing expertise and local knowledge ensure your property reaches the right buyers at the right price."
        features={[
          { text: 'Professional Photography' },
          { text: 'Premium Portal Listings' },
          { text: 'Expert Negotiation' },
        ]}
        image="https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=600&h=400&fit=crop"
        imageAlt="Property for sale"
      >
        <Fragment slot="icon">
          <div class="showcase__card-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
          </div>
        </Fragment>
      </ShowcaseCard>

      <ShowcaseCard
        variant="secondary"
        subtitle="Stress-Free Sales"
        description="We handle everything from viewings to completion, keeping you informed every step of the way."
        image="https://images.unsplash.com/photo-1582407947304-fd86f028f716?w=400&h=500&fit=crop"
        imageAlt="Happy sellers"
        tallImage
      />
    </ShowcaseGrid>

    <!-- Content Section -->
    <ContentSection>
      <!-- Row 1: Our Approach (block_key: our_approach) -->
      <ContentRow
        label="Our Approach"
        blockKey="our_approach"
        pageContent={pageContent}
        title="Our Approach to Selling"
      >
        {!hasOurApproach && (
          <Fragment>
            <p class="content__text">
              Selling a property is one of the biggest financial decisions you'll make. That's why we take a personalised approach, combining local market expertise with modern marketing strategies to attract the right buyers and achieve the best price.
            </p>
            <p class="content__text">
              From the initial valuation to completion, we keep you informed every step of the way, providing honest advice and dedicated support throughout.
            </p>
          </Fragment>
        )}
      </ContentRow>

      <!-- Row 2: Selling Process (block_key: selling_process) -->
      <ContentRow
        label="The Process"
        blockKey="selling_process"
        pageContent={pageContent}
        title="The Selling Process"
        listItems={!hasSellingProcess ? [
          'Free, no-obligation market valuations',
          'Professional photography and floor plans',
          'Listings on Rightmove, Zoopla and OnTheMarket',
          'Accompanied viewings at times that suit you',
          'Expert negotiation to maximise your sale price',
          'Sales progression through to completion',
        ] : []}
      >
        {!hasSellingProcess && (
          <p class="content__text">
            We provide everything you need to sell your property quickly and for the best price, with no hidden surprises along the way.
          </p>
        )}
      </ContentRow>

      <!-- Row 3: Fees (block_key: fees) -->
      <ContentRow
        label="Our Fees"
        blockKey="fees"
        pageContent={pageContent}
        title="Our Fees"
        highlights={[
          { value: '98%', label: 'Asking price achieved' },
          { value: '6 weeks', label: 'Average time to offer' },
          { value: '500+', label: 'Properties sold' },
        ]}
      >
        {!hasFees && (
          <p class="content__text">
            Our track record speaks for itself. We consistently achieve asking price or above for our clients, and our dedication to exceptional service means you're always in safe hands.
          </p>
        )}
      </ContentRow>

      <!-- Row 4: CTA -->
      <ContentRow
        label="Get Started"
        title="Ready to sell your property?"
        isCta
        actions={[
          { label: 'Book a Valuation', url: '/valuation', variant: 'primary', icon: true },
          { label: 'Contact Us', url: '/contact', variant: 'secondary' },
        ]}
      >
        <p class="content__text">
          Book a free valuation today and discover what your property could be worth. Our team is ready to help you every step of the way.
        </p>
      </ContentRow>
    </ContentSection>
  </StaticPageLayout>
</Layout>

<style lang="scss">
  @use '../styles/variables' as *;

  .content__text {
    font-size: 1.0625rem;
    color: $text-secondary;
    line-height: 1.75;
    margin: 0 0 20px 0;

    &:last-child {
      margin-bottom: 0;
    }
  }
</style>
