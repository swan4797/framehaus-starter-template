---
// ========================================
// HOMEPAGE
// UK Estate Agent Homepage - Dynamically Branded
// ========================================

import Layout from '../layouts/Layout.astro'
import { searchProperties } from '../lib/api'
import PropertyCard from '../components/properties/PropertyCard.astro'
import Hero from '../components/Hero.astro'
import HeroSplitScreen from '../components/HeroSplit.astro'
import { siteConfig } from '../lib/config'
import LuxurySearchBar from '../components/search/LuxurySearchBar.astro'
import UniversalSearchBar from '../components/search/UniversalSearchBar.astro'

// ✅ Import brand utilities
import { 
  fetchBrandSettings, 
  getContactInfo, 
  getSocialLinks,
} from '../lib/brand'

// ✅ Fetch brand settings
// const brand = await fetchBrandSettings()
const brand = await fetchBrandSettings(true) // true = force refresh

const contact = getContactInfo(brand)
const social = getSocialLinks(brand)

// Fetch featured and recent properties
const [featuredResponse, saleResponse, letResponse] = await Promise.all([
  searchProperties({ listing_type: 'sale', limit: 6, sort_by: 'newest' }),
  searchProperties({ listing_type: 'sale', limit: 3, sort_by: 'newest' }),
  searchProperties({ listing_type: 'let', limit: 3, sort_by: 'newest' }),
])

const featuredProperties = featuredResponse?.properties.filter(p => p.is_featured).slice(0, 3) || []
const saleProperties = saleResponse?.properties || []
const letProperties = letResponse?.properties || []

// Get total property counts
const totalForSale = featuredResponse?.total || 0
const totalToLet = 0 // Would need separate count query

// Property showcase images
const propertyImages = [
  {
    src: 'https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=400',
    alt: 'Modern prefab home with deck',
  },
  {
    src: 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=400',
    alt: 'Wooden tiny home on wheels',
  },
  {
    src: 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=400',
    alt: 'A-frame cabin in the woods',
  },
  {
    src: 'https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=400',
    alt: 'Modern container home',
  },
];
---

<Layout>
<HeroSplitScreen
  headline={brand.tagline || "The prefab home of your dreams is here"}
  description={brand.mission_statement || "Find the best prefab homes, ADUs, cabins, and more."}
  ctaText="Start exploring"
  ctaLink="/explore"
  propertyImages={propertyImages}
  backgroundColor={brand.background_secondary}
/>  




<h1>{brand.business_name}</h1>


  <LuxurySearchBar 
    fields={{
      listingType: true,
      location: true,
      minPrice: true,
      maxPrice: true,
    }}
    theme="dark"
  />


  <!-- Featured Properties -->
  {featuredProperties.length > 0 && (
    <section class="py-16 md:py-20" style={`background-color: ${brand.background_primary};`}>
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between mb-10">
          <div>
            <h2 class="text-3xl md:text-4xl font-bold mb-2" style={`color: ${brand.text_primary}; font-family: ${brand.heading_font_family}, sans-serif; font-weight: ${brand.heading_font_weight};`}>
              Featured Properties
            </h2>
            <p class="text-lg" style={`color: ${brand.text_secondary};`}>
              Carefully selected homes that won't last long
            </p>
          </div>
          <a
            href="/search"
            class="hidden md:inline-flex items-center font-semibold hover:opacity-80 transition-opacity"
            style={`color: ${brand.primary_color};`}
          >
            View all properties
            <svg class="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
          {featuredProperties.map(property => (
            <PropertyCard property={property} featured={true} />
          ))}
        </div>

        <div class="text-center mt-10 md:hidden">
          <a
            href="/search"
            class="inline-flex items-center px-8 py-3 rounded-lg transition-all font-semibold shadow-lg"
            style={`background-color: ${brand.primary_color}; color: ${brand.text_light}; border-radius: ${brand.border_radius === 'full' ? '9999px' : brand.border_radius === 'large' ? '12px' : brand.border_radius === 'small' ? '4px' : '8px'};`}
          >
            View All Properties
            <svg class="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>
      </div>
    </section>
  )}

  <!-- Properties For Sale -->
  {saleProperties.length > 0 && (
    <section class="py-16 md:py-20" style={`background-color: ${brand.background_secondary};`}>
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between mb-10">
          <div>
            <h2 class="text-3xl md:text-4xl font-bold mb-2" style={`color: ${brand.text_primary}; font-family: ${brand.heading_font_family}, sans-serif; font-weight: ${brand.heading_font_weight};`}>
              Recently Added For Sale
            </h2>
            <p class="text-lg" style={`color: ${brand.text_secondary};`}>
              The latest properties on the market
            </p>
          </div>
          <a
            href="/search?listing_type=sale"
            class="hidden md:inline-flex items-center font-semibold hover:opacity-80 transition-opacity"
            style={`color: ${brand.primary_color};`}
          >
            View all for sale
            <svg class="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
          {saleProperties.map(property => (
            <PropertyCard property={property} />
          ))}
        </div>

        <div class="text-center mt-10 md:hidden">
         <a 
            href="/search?listing_type=sale"
            class="inline-flex items-center font-semibold hover:opacity-80 transition-opacity"
            style={`color: ${brand.primary_color};`}
          >
            View all for sale
            <svg class="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>
      </div>
    </section>
  )}

  <!-- Properties To Rent -->
  {letProperties.length > 0 && (
    <section class="py-16 md:py-20" style={`background-color: ${brand.background_primary};`}>
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between mb-10">
          <div>
            <h2 class="text-3xl md:text-4xl font-bold mb-2" style={`color: ${brand.text_primary}; font-family: ${brand.heading_font_family}, sans-serif; font-weight: ${brand.heading_font_weight};`}>
              Recently Added To Rent
            </h2>
            <p class="text-lg" style={`color: ${brand.text_secondary};`}>
              Available rental properties
            </p>
          </div>
          <a
            href="/search?listing_type=let"
            class="hidden md:inline-flex items-center font-semibold hover:opacity-80 transition-opacity"
            style={`color: ${brand.primary_color};`}
          >
            View all to rent
            <svg class="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
          {letProperties.map(property => (
            <PropertyCard property={property} />
          ))}
        </div>

        <div class="text-center mt-10 md:hidden">
         <a 
            href="/search?listing_type=let"
            class="inline-flex items-center font-semibold hover:opacity-80 transition-opacity"
            style={`color: ${brand.primary_color};`}
          >
            View all to rent
            <svg class="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>
      </div>
    </section>
  )}

  <!-- Why Choose Us / Services -->
  <section class="py-16 md:py-20" style={`background: ${brand.background_dark}; color: ${brand.text_light};`}>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl md:text-4xl font-bold mb-4" style={`font-family: ${brand.heading_font_family}, sans-serif; font-weight: ${brand.heading_font_weight};`}>
          Why Instruct {brand.business_name}?
        </h2>
        <p class="text-xl max-w-2xl mx-auto" style="opacity: 0.9;">
          Expert local knowledge combined with innovative marketing
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <!-- Local Expertise -->
        <div class="text-center">
          <div class="w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg" style={`background: linear-gradient(135deg, ${brand.primary_color}, ${brand.accent_color});`}>
            <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </div>
          <h3 class="text-xl font-semibold mb-2" style={`font-family: ${brand.heading_font_family}, sans-serif;`}>
            Local Experts
          </h3>
          <p style="opacity: 0.8;">
            In-depth knowledge of the area, schools, transport and amenities
          </p>
        </div>

        <!-- Performance Data -->
        <div class="text-center">
          <div class="w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg" style={`background: linear-gradient(135deg, ${brand.primary_color}, ${brand.accent_color});`}>
            <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
            </svg>
          </div>
          <h3 class="text-xl font-semibold mb-2" style={`font-family: ${brand.heading_font_family}, sans-serif;`}>
            Data-Driven Marketing
          </h3>
          <p style="opacity: 0.8;">
            Track your property's performance with detailed analytics
          </p>
        </div>

        <!-- Professional Photography -->
        <div class="text-center">
          <div class="w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg" style={`background: linear-gradient(135deg, ${brand.primary_color}, ${brand.accent_color});`}>
            <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </div>
          <h3 class="text-xl font-semibold mb-2" style={`font-family: ${brand.heading_font_family}, sans-serif;`}>
            Professional Media
          </h3>
          <p style="opacity: 0.8;">
            High-quality photography, floor plans and virtual tours
          </p>
        </div>

        <!-- Dedicated Support -->
        <div class="text-center">
          <div class="w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg" style={`background: linear-gradient(135deg, ${brand.primary_color}, ${brand.accent_color});`}>
            <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
            </svg>
          </div>
          <h3 class="text-xl font-semibold mb-2" style={`font-family: ${brand.heading_font_family}, sans-serif;`}>
            Personal Service
          </h3>
          <p style="opacity: 0.8;">
            Dedicated agent guiding you from valuation to completion
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Area Guide / Stats Section -->
  {brand.about_text && (
    <section class="py-16 md:py-20" style={`background-color: ${brand.background_primary};`}>
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
          <!-- Content -->
          <div>
            <h2 class="text-3xl md:text-4xl font-bold mb-6" style={`color: ${brand.text_primary}; font-family: ${brand.heading_font_family}, sans-serif; font-weight: ${brand.heading_font_weight};`}>
              About {brand.business_name}
            </h2>
            <p class="text-lg mb-6" style={`color: ${brand.text_secondary}; font-family: ${brand.body_font_family}, sans-serif;`}>
              {brand.about_text}
            </p>
            <div class="grid grid-cols-2 gap-6 mb-8">
              <div class="border-l-4 pl-4" style={`border-color: ${brand.primary_color};`}>
                <div class="text-3xl font-bold mb-1" style={`color: ${brand.text_primary};`}>500+</div>
                <div class="text-sm" style={`color: ${brand.text_secondary};`}>Properties Sold</div>
              </div>
              <div class="border-l-4 pl-4" style={`border-color: ${brand.primary_color};`}>
                <div class="text-3xl font-bold mb-1" style={`color: ${brand.text_primary};`}>98%</div>
                <div class="text-sm" style={`color: ${brand.text_secondary};`}>Customer Satisfaction</div>
              </div>
              <div class="border-l-4 pl-4" style={`border-color: ${brand.primary_color};`}>
                <div class="text-3xl font-bold mb-1" style={`color: ${brand.text_primary};`}>£450M+</div>
                <div class="text-sm" style={`color: ${brand.text_secondary};`}>Properties Transacted</div>
              </div>
              <div class="border-l-4 pl-4" style={`border-color: ${brand.primary_color};`}>
                <div class="text-3xl font-bold mb-1" style={`color: ${brand.text_primary};`}>15+</div>
                <div class="text-sm" style={`color: ${brand.text_secondary};`}>Years Experience</div>
              </div>
            </div>
            <a
              href="/about"
              class="inline-flex items-center font-semibold hover:opacity-80 transition-opacity"
              style={`color: ${brand.primary_color};`}
            >
              Learn more about us
              <svg class="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          </div>

          <!-- Image/Placeholder -->
          <div class="relative">
            {brand.about_image_url ? (
              <div class="aspect-[4/3] rounded-2xl overflow-hidden shadow-xl">
                <img src={brand.about_image_url} alt={`About ${brand.business_name}`} class="w-full h-full object-cover" />
              </div>
            ) : (
              <div class="aspect-[4/3] rounded-2xl overflow-hidden shadow-xl" style={`background: linear-gradient(135deg, ${brand.background_secondary}, ${brand.secondary_color});`}>
                <div class="w-full h-full flex items-center justify-center" style={`color: ${brand.text_secondary};`}>
                  <svg class="w-24 h-24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                  </svg>
                </div>
              </div>
            )}
            <!-- Decorative element -->
            <div class="absolute -bottom-6 -right-6 w-64 h-64 rounded-full blur-3xl -z-10" style={`background-color: ${brand.primary_color}; opacity: 0.1;`}></div>
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- Free Valuation CTA -->
  <section class="relative py-20 md:py-28 overflow-hidden">
    <!-- Gradient Background -->
    <div class="absolute inset-0" style={`background: linear-gradient(135deg, ${brand.primary_color}, ${brand.accent_color || brand.primary_color}, ${brand.background_dark});`}></div>
    
    <!-- Pattern Overlay -->
    <div class="absolute inset-0 opacity-10">
      <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
    </div>

    <div class="relative max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center" style={`color: ${brand.text_light};`}>
      <div class="mb-8">
        <div class="inline-flex items-center justify-center w-20 h-20 rounded-full backdrop-blur-sm mb-6" style="background-color: rgba(255, 255, 255, 0.1);">
          <svg class="w-10 h-10" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
        </div>
        <h2 class="text-3xl md:text-5xl font-bold mb-4" style={`font-family: ${brand.heading_font_family}, sans-serif; font-weight: ${brand.heading_font_weight};`}>
          Thinking of Selling or Letting?
        </h2>
        <p class="text-xl md:text-2xl mb-2" style="opacity: 0.95;">
          Get an instant online valuation in 60 seconds
        </p>
        <p class="text-lg" style="opacity: 0.85;">
          Or book a free home visit from one of our expert valuers
        </p>
      </div>

      <div class="flex flex-col sm:flex-row gap-4 justify-center mb-8">
        <a
          href="/valuation"
          class="inline-flex items-center justify-center px-8 py-4 transition-all font-semibold text-lg shadow-xl group"
          style={`background-color: ${brand.background_primary}; color: ${brand.primary_color}; border-radius: ${brand.border_radius === 'full' ? '9999px' : brand.border_radius === 'large' ? '12px' : brand.border_radius === 'small' ? '4px' : '8px'};`}
        >
          Get Free Valuation
          <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </a>
        {contact.phone && (
          <a
            href={`tel:${contact.phone}`}
            class="inline-flex items-center justify-center px-8 py-4 transition-all font-semibold text-lg border-2 group"
            style={`background-color: rgba(255, 255, 255, 0.1); color: ${brand.text_light}; border-color: rgba(255, 255, 255, 0.3); border-radius: ${brand.border_radius === 'full' ? '9999px' : brand.border_radius === 'large' ? '12px' : brand.border_radius === 'small' ? '4px' : '8px'};`}
          >
            <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
            </svg>
            {contact.phone}
          </a>
        )}
      </div>

      <!-- Trust Indicators -->
      <div class="flex flex-wrap items-center justify-center gap-6 text-sm" style="opacity: 0.85;">
        <div class="flex items-center">
          <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="opacity: 0.9;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
          No obligation
        </div>
        <div class="flex items-center">
          <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="opacity: 0.9;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
          Instant results
        </div>
        <div class="flex items-center">
          <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="opacity: 0.9;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
          Expert local valuers
        </div>
      </div>
    </div>
  </section>

  <!-- Newsletter / Updates Section -->
  <section class="py-16" style={`background-color: ${brand.background_secondary};`}>
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-2xl md:text-3xl font-bold mb-4" style={`color: ${brand.text_primary}; font-family: ${brand.heading_font_family}, sans-serif; font-weight: ${brand.heading_font_weight};`}>
        Stay Updated on Local Property
      </h2>
      <p class="text-lg mb-8" style={`color: ${brand.text_secondary};`}>
        Get the latest properties and market insights delivered to your inbox
      </p>
      <form class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
        <input
          type="email"
          placeholder="Your email address"
          class="flex-1 px-4 py-3 border-2 focus:outline-none"
          style={`border-color: ${brand.secondary_color}; border-radius: ${brand.border_radius === 'full' ? '9999px' : brand.border_radius === 'large' ? '12px' : brand.border_radius === 'small' ? '4px' : '8px'}; font-family: ${brand.body_font_family}, sans-serif;`}
        />
        <button
          type="submit"
          class="px-8 py-3 transition-colors font-semibold whitespace-nowrap"
          style={`background-color: ${brand.primary_color}; color: ${brand.text_light}; border-radius: ${brand.border_radius === 'full' ? '9999px' : brand.border_radius === 'large' ? '12px' : brand.border_radius === 'small' ? '4px' : '8px'};`}
        >
          Subscribe
        </button>
      </form>
      <p class="text-sm mt-4" style={`color: ${brand.text_secondary};`}>
        We respect your privacy. Unsubscribe at any time.
      </p>
    </div>
  </section>
</Layout>

<script>
  // Dynamic price range switching between sale and rent
  document.addEventListener('DOMContentLoaded', () => {
    const listingTypeInputs = document.querySelectorAll('input[name="listing_type"]')
    const minPriceSelect = document.getElementById('min_price') as HTMLSelectElement
    const maxPriceSelect = document.getElementById('max_price') as HTMLSelectElement

    if (!minPriceSelect || !maxPriceSelect) return

    // Sale price ranges
    const salePrices = {
      min: [
        { value: '', label: 'No min' },
        { value: '100000', label: '£100,000' },
        { value: '200000', label: '£200,000' },
        { value: '300000', label: '£300,000' },
        { value: '400000', label: '£400,000' },
        { value: '500000', label: '£500,000' },
        { value: '750000', label: '£750,000' },
        { value: '1000000', label: '£1,000,000' },
      ],
      max: [
        { value: '', label: 'No max' },
        { value: '200000', label: '£200,000' },
        { value: '300000', label: '£300,000' },
        { value: '400000', label: '£400,000' },
        { value: '500000', label: '£500,000' },
        { value: '750000', label: '£750,000' },
        { value: '1000000', label: '£1,000,000' },
        { value: '2000000', label: '£2,000,000' },
      ],
    }

    // Rent price ranges (monthly)
    const rentPrices = {
      min: [
        { value: '', label: 'No min' },
        { value: '500', label: '£500 pcm' },
        { value: '750', label: '£750 pcm' },
        { value: '1000', label: '£1,000 pcm' },
        { value: '1250', label: '£1,250 pcm' },
        { value: '1500', label: '£1,500 pcm' },
        { value: '2000', label: '£2,000 pcm' },
        { value: '2500', label: '£2,500 pcm' },
      ],
      max: [
        { value: '', label: 'No max' },
        { value: '750', label: '£750 pcm' },
        { value: '1000', label: '£1,000 pcm' },
        { value: '1250', label: '£1,250 pcm' },
        { value: '1500', label: '£1,500 pcm' },
        { value: '2000', label: '£2,000 pcm' },
        { value: '2500', label: '£2,500 pcm' },
        { value: '3000', label: '£3,000 pcm' },
      ],
    }

    function updatePriceRanges(listingType: 'sale' | 'let') {
      const prices = listingType === 'sale' ? salePrices : rentPrices

      // Update min price options
      minPriceSelect.innerHTML = ''
      prices.min.forEach(option => {
        const opt = document.createElement('option')
        opt.value = option.value
        opt.textContent = option.label
        minPriceSelect.appendChild(opt)
      })

      // Update max price options
      maxPriceSelect.innerHTML = ''
      prices.max.forEach(option => {
        const opt = document.createElement('option')
        opt.value = option.value
        opt.textContent = option.label
        maxPriceSelect.appendChild(opt)
      })
    }

    // Listen for listing type changes
    listingTypeInputs.forEach(input => {
      input.addEventListener('change', (e) => {
        const target = e.target as HTMLInputElement
        updatePriceRanges(target.value as 'sale' | 'let')
      })
    })
  })
</script>