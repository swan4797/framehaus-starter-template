---
// ========================================
// TENANTS PAGE
// Services page for property tenants
// Dynamic content from Stratos CRM
// ========================================

import Layout from '../layouts/Layout.astro'

// Static Page Components
import StaticPageLayout from '../components/static-page/layout/StaticPageLayout.astro'
import StaticHero from '../components/static-page/hero/StaticHero.astro'
import ShowcaseGrid from '../components/static-page/showcase/ShowcaseGrid.astro'
import ShowcaseCard from '../components/static-page/showcase/ShowcaseCard.astro'
import ContentSection from '../components/static-page/content/ContentSection.astro'
import ContentRow from '../components/static-page/content/ContentRow.astro'

// Page content utilities
import { getPageContent, hasSection } from '../lib/pages'

// Page configuration
import { tenantsPageConfig } from '../components/static-page/config'

const pageTitle = 'Renting a Property'
const pageDescription = 'Find your perfect rental home with our expert help. Quality properties and excellent tenant support.'

// Fetch tenants page content from Stratos CRM
const pageContent = await getPageContent('tenants')

// Check which sections exist in CRM
const hasHowToRent = hasSection(pageContent, 'how_to_rent')
const hasWhatYouNeed = hasSection(pageContent, 'what_you_need')
const hasTenantFaqs = hasSection(pageContent, 'tenant_faqs')
---

<Layout title={pageTitle} description={pageDescription}>
  <StaticPageLayout>
    <!-- Hero Section -->
    <StaticHero
      label={tenantsPageConfig.hero.label}
      titleLines={tenantsPageConfig.hero.titleLines}
      tagline="Discover quality rental properties and enjoy excellent support throughout your tenancy."
      ctaLabel={tenantsPageConfig.hero.ctaLabel}
      ctaUrl={tenantsPageConfig.hero.ctaUrl}
    />

    <!-- Showcase Section -->
    <ShowcaseGrid>
      <ShowcaseCard
        variant="blue"
        title="Quality Rental Homes"
        description="Browse verified properties that meet our high standards for comfort and condition."
        features={[
          { text: 'Verified Properties' },
          { text: 'Clear, Upfront Costs' },
          { text: 'Fast Applications' },
        ]}
        image="https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?w=600&h=400&fit=crop"
        imageAlt="Modern rental apartment"
      >
        <Fragment slot="icon">
          <div class="showcase__card-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path>
              <path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            </svg>
          </div>
        </Fragment>
      </ShowcaseCard>

      <ShowcaseCard
        variant="amber"
        subtitle="Tenant Support"
        description="Dedicated support throughout your tenancy with quick responses to any queries or maintenance needs."
        image="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=400&h=500&fit=crop"
        imageAlt="Happy tenants"
        tallImage
      />
    </ShowcaseGrid>

    <!-- Content Section -->
    <ContentSection>
      <!-- Row 1: How To Rent (block_key: how_to_rent) -->
      <ContentRow
        label="How To Rent"
        blockKey="how_to_rent"
        pageContent={pageContent}
        title="How To Rent"
      >
        {!hasHowToRent && (
          <Fragment>
            <p class="content__text">
              Looking for a rental property should be an exciting experience, not a stressful one. We make the process straightforward, with clear information about every property and a simple, transparent application process.
            </p>
            <p class="content__text">
              Once you've found your home, our dedicated team is here to support you throughout your tenancy, responding quickly to any queries or maintenance issues.
            </p>
          </Fragment>
        )}
      </ContentRow>

      <!-- Row 2: What You Need (block_key: what_you_need) -->
      <ContentRow
        label="What You Need"
        blockKey="what_you_need"
        pageContent={pageContent}
        title="What You'll Need"
        listItems={!hasWhatYouNeed ? [
          'Verified, quality properties',
          'Flexible viewing times',
          'Clear, upfront costs',
          'Fast application processing',
          'Dedicated tenant support',
          '24/7 emergency contact',
        ] : []}
      >
        {!hasWhatYouNeed && (
          <p class="content__text">
            All our rental properties meet high standards, and we ensure everything is in order before you move in. Here's what you can expect when renting through us.
          </p>
        )}
      </ContentRow>

      <!-- Row 3: Tenant FAQs (block_key: tenant_faqs) -->
      <ContentRow
        label="FAQs"
        blockKey="tenant_faqs"
        pageContent={pageContent}
        title="Frequently Asked Questions"
      >
        {!hasTenantFaqs && (
          <Fragment>
            <p class="content__text">
              We've streamlined the rental process to get you into your new home as quickly as possible. After you've found a property you love, we'll guide you through referencing, agreements, and move-in â€” keeping you updated every step of the way.
            </p>
            <p class="content__text">
              Our team handles all the paperwork and coordinates with landlords, so you can focus on planning your move.
            </p>
          </Fragment>
        )}
      </ContentRow>

      <!-- Row 4: CTA -->
      <ContentRow
        label="Get Started"
        title="Ready to find your rental?"
        isCta
        actions={[
          { label: 'View Rentals', url: '/search?listing_type=let', variant: 'primary', icon: true },
          { label: 'Register Interest', url: '/contact', variant: 'secondary' },
        ]}
      >
        <p class="content__text">
          Browse our available properties or register with us to be notified when new rentals matching your criteria become available.
        </p>
      </ContentRow>
    </ContentSection>
  </StaticPageLayout>
</Layout>

<style lang="scss">
  @use '../styles/variables' as *;

  .content__text {
    font-size: 1.0625rem;
    color: $text-secondary;
    line-height: 1.75;
    margin: 0 0 20px 0;

    &:last-child {
      margin-bottom: 0;
    }
  }
</style>
