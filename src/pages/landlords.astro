---
// ========================================
// LANDLORDS PAGE
// Services page for property landlords
// Dynamic content from Stratos CRM
// ========================================

import Layout from '../layouts/Layout.astro'

// Static Page Components
import StaticPageLayout from '../components/static-page/layout/StaticPageLayout.astro'
import StaticHero from '../components/static-page/hero/StaticHero.astro'
import ShowcaseGrid from '../components/static-page/showcase/ShowcaseGrid.astro'
import ShowcaseCard from '../components/static-page/showcase/ShowcaseCard.astro'
import ContentSection from '../components/static-page/content/ContentSection.astro'
import ContentRow from '../components/static-page/content/ContentRow.astro'

// Page content utilities
import { getPageContent, hasSection } from '../lib/pages'

// Page configuration
import { landlordsPageConfig } from '../components/static-page/config'

const pageTitle = 'Landlord Services'
const pageDescription = 'Professional letting and property management services for landlords. Maximise your rental income with expert support.'

// Fetch landlords page content from Stratos CRM
const pageContent = await getPageContent('landlords')

// Check which sections exist in CRM
const hasServices = hasSection(pageContent, 'services')
const hasWhyLet = hasSection(pageContent, 'why_let_with_us')
const hasCompliance = hasSection(pageContent, 'compliance')
---

<Layout title={pageTitle} description={pageDescription}>
  <StaticPageLayout>
    <!-- Hero Section -->
    <StaticHero
      label={landlordsPageConfig.hero.label}
      titleLines={landlordsPageConfig.hero.titleLines}
      tagline="From finding quality tenants to full property management, we take the stress out of being a landlord."
      ctaLabel={landlordsPageConfig.hero.ctaLabel}
      ctaUrl={landlordsPageConfig.hero.ctaUrl}
    />

    <!-- Showcase Section -->
    <ShowcaseGrid>
      <ShowcaseCard
        variant="primary"
        title="Reliable Rental Income"
        description="Quality tenants, minimal voids, and professional management to protect your investment."
        features={[
          { text: 'Thorough Tenant Vetting' },
          { text: 'Rent Collection' },
          { text: 'Legal Compliance' },
        ]}
        image="https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=600&h=400&fit=crop"
        imageAlt="Rental property"
      >
        <Fragment slot="icon">
          <div class="showcase__card-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
              <line x1="16" x2="16" y1="2" y2="6"></line>
              <line x1="8" x2="8" y1="2" y2="6"></line>
              <line x1="3" x2="21" y1="10" y2="10"></line>
            </svg>
          </div>
        </Fragment>
      </ShowcaseCard>

      <ShowcaseCard
        variant="secondary"
        subtitle="Full Management"
        description="Let us handle everything while you enjoy the returns. Maintenance, inspections, and tenant relations â€” all covered."
        image="https://images.unsplash.com/photo-1554224155-8d04cb21cd6c?w=400&h=500&fit=crop"
        imageAlt="Property management"
        tallImage
      />
    </ShowcaseGrid>

    <!-- Content Section -->
    <ContentSection>
      <!-- Row 1: Services (block_key: services) -->
      <ContentRow
        label="Our Services"
        blockKey="services"
        pageContent={pageContent}
        title="Our Landlord Services"
      >
        {!hasServices && (
          <Fragment>
            <p class="content__text">
              Whether you own one property or a portfolio, we understand that your rental income matters. Our letting services are designed to minimise void periods, find reliable tenants, and ensure your property is well-maintained.
            </p>
            <p class="content__text">
              We stay up-to-date with all the latest legislation and compliance requirements, so you can have peace of mind that everything is being handled correctly.
            </p>
          </Fragment>
        )}
      </ContentRow>

      <!-- Row 2: Why Let With Us (block_key: why_let_with_us) -->
      <ContentRow
        label="Why Let With Us"
        blockKey="why_let_with_us"
        pageContent={pageContent}
        title="Why Let With Us"
        listItems={!hasWhyLet ? [
          'Tenant find service',
          'Rent collection',
          'Full property management',
          'Inventory and check-in/out',
          'Maintenance coordination',
          'Legal compliance management',
        ] : []}
      >
        {!hasWhyLet && (
          <p class="content__text">
            We offer a range of services so you can choose the level of support that works best for you, from tenant-find only to fully managed.
          </p>
        )}
      </ContentRow>

      <!-- Row 3: Compliance (block_key: compliance) -->
      <ContentRow
        label="Compliance"
        blockKey="compliance"
        pageContent={pageContent}
        title="Compliance & Safety"
        highlights={[
          { value: '14 days', label: 'Average time to let' },
          { value: '99%', label: 'Rent collection rate' },
          { value: '200+', label: 'Properties managed' },
        ]}
      >
        {!hasCompliance && (
          <p class="content__text">
            Our landlords stay with us because we deliver results. We pride ourselves on thorough tenant referencing, competitive fees, and responsive communication that keeps you informed without overwhelming you.
          </p>
        )}
      </ContentRow>

      <!-- Row 4: CTA -->
      <ContentRow
        label="Get Started"
        title="Ready to let your property?"
        isCta
        actions={[
          { label: 'Request Valuation', url: '/contact', variant: 'primary', icon: true },
          { label: 'Contact Us', url: '/contact', variant: 'secondary' },
        ]}
      >
        <p class="content__text">
          Get a free rental valuation and find out how we can help you maximise your rental income while minimising the hassle.
        </p>
      </ContentRow>
    </ContentSection>
  </StaticPageLayout>
</Layout>

<style lang="scss">
  @use '../styles/variables' as *;

  .content__text {
    font-size: 1.0625rem;
    color: $text-secondary;
    line-height: 1.75;
    margin: 0 0 20px 0;

    &:last-child {
      margin-bottom: 0;
    }
  }
</style>
