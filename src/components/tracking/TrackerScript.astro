---
// Tracker initialization component
// Include this in your Layout.astro

const API_ENDPOINT = import.meta.env.PUBLIC_STRATOS_API_ENDPOINT
const API_KEY = import.meta.env.PUBLIC_STRATOS_API_KEY
const AGENCY_ID = import.meta.env.PUBLIC_AGENCY_ID
---

<script>
  import tracker from '../../lib/tracking/tracker'

  // Initialize tracker on DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initTracker)
  } else {
    initTracker()
  }

  function initTracker() {
    // Check if we're in development mode
    const isDev = import.meta.env.DEV

    // Initialize tracker
    window.StratosTracker = tracker
    
    tracker.init({
      apiEndpoint: import.meta.env.PUBLIC_STRATOS_API_ENDPOINT,
      apiKey: import.meta.env.PUBLIC_STRATOS_API_KEY,
      agencyId: import.meta.env.PUBLIC_AGENCY_ID,
      cookieConsent: true, // or check for user consent
      sessionTimeout: 30,
      debug: isDev,
    })
  }
</script>